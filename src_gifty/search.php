<html>
<title>Search</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="style24.css">
<link rel="stylesheet" href="style4.css">
<style>
.w3-sidebar a {font-family: "Roboto", sans-serif}
body,h1,h2,h3,h4,h5,h6,.w3-wide {font-family: "Montserrat", sans-serif;}
</style>
<body class="w3-content" style="max-width:1200px">

<!-- Sidebar/menu -->
<nav class="navbar" style="z-index:1;">
  <ul class="navbar-nav">
      <li class="logo">
        <a href="home.php" class="nav-link">
          <span class="link-text logo-text">HOME</span>
		  <!-- the svg are the icons of the menue -->
          <svg
            aria-hidden="true"
            focusable="false"
            data-prefix="fad"
            data-icon="angle-double-right"
            role="img"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 448 512"
            class="svg-inline--fa fa-angle-double-right fa-w-14 fa-5x"
          >
            <g class="fa-group">
              <path
                fill="currentColor"
                d="M224 273L88.37 409a23.78 23.78 0 0 1-33.8 0L32 386.36a23.94 23.94 0 0 1 0-33.89l96.13-96.37L32 159.73a23.94 23.94 0 0 1 0-33.89l22.44-22.79a23.78 23.78 0 0 1 33.8 0L223.88 239a23.94 23.94 0 0 1 .1 34z"
                class="fa-secondary"
              ></path>
              <path
                fill="currentColor"
                d="M415.89 273L280.34 409a23.77 23.77 0 0 1-33.79 0L224 386.26a23.94 23.94 0 0 1 0-33.89L320.11 256l-96-96.47a23.94 23.94 0 0 1 0-33.89l22.52-22.59a23.77 23.77 0 0 1 33.79 0L416 239a24 24 0 0 1-.11 34z"
                class="fa-primary"
              ></path>
            </g>
          </svg>
        </a>
      </li>
	  
	   
     <li class="nav-item">
        <a href="search.php" class="nav-link">
          <img src="2072119491582004497-128.png" style="height:50px; margin-left:10%;">
          <span class="link-text">Search</span>
        </a>
      </li> 
	  
	  
	  
	  
<li href="Loginsignup.php" class="nav-item">
      
          <a href="Loginsignup.php" class="nav-link">
          <img src="1657310781582004494-128.png" style="height:50px; margin-left:10%;">
          <span class="link-text">Log in</span>
        </a>
      </li>
	  
	  
	  
     <li class="nav-item">
        <a href="profile.php" class="nav-link">
          <img src="1388560951582004484-128.png" style="height:50px; margin-left:10%;">
          <span class="link-text">Profile</span>
        </a>
      </li>

     <li class="nav-item">
        <a href="shop.php" class="nav-link">
          <img src="7770838881582004485-128.png" style="height:50px; margin-left:10%;">
          <span class="link-text">Shop</span>
        </a>
      </li>



      <li class="nav-item">
        <a href="subscription box.php" class="nav-link">
		 <img src="2058381931582004487-128.png" style="height:50px; margin-left:10%;">
        
      
          <span class="link-text">Mystery Box</span>
        </a>
      </li>
	  
	  
	  	       <li class="nav-item">
        <button style='border:none; background:none;' ><a href="filling.php" class="nav-link">
		<img src="2252295991582004497-128.png" style="height:50px; margin-left:10%;">

          <span class="link-text">Manager's Space</span> 
        </a></button>
      </li>
	  
 <li class="nav-item">
        <a href="logout.php" class="nav-link">
         <img src="8474278001582004491-128.png" style="height:50px; margin-left:10%;">
          <span class="link-text">Logout</span>
        </a>
      </li>

 <li class="nav-item" >
        <a href="about-us.php" class="nav-link">
		<img src="9468673611582004493-128.png" style="height:50px; margin-left:10%;">
        
          <span class="link-text">About Us</span>
        </a>
      </li>




    </ul>
  </nav>
<nav class="navbar2" style="z-index:1;">
  <ul class="navbar-nav2">
      <li class="logo">
        <a href="shop.php" class="nav-link">
	<span class="link-text logo-text">SHOP</span>
		  <!-- the svg are the icons of the menue -->
          <svg
            aria-hidden="true"
            focusable="false"
            data-prefix="fad"
            data-icon="angle-double-right"
            role="img"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 448 512"
            class="svg-inline--fa fa-angle-double-right fa-w-14 fa-5x"
			
          >
            <g class="fa-group">
              <path
                fill="currentColor"
                d="M224 273L88.37 409a23.78 23.78 0 0 1-33.8 0L32 386.36a23.94 23.94 0 0 1 0-33.89l96.13-96.37L32 159.73a23.94 23.94 0 0 1 0-33.89l22.44-22.79a23.78 23.78 0 0 1 33.8 0L223.88 239a23.94 23.94 0 0 1 .1 34z"
                class="fa-secondary"
              ></path>
              <path
                fill="currentColor"
                d="M415.89 273L280.34 409a23.77 23.77 0 0 1-33.79 0L224 386.26a23.94 23.94 0 0 1 0-33.89L320.11 256l-96-96.47a23.94 23.94 0 0 1 0-33.89l22.52-22.59a23.77 23.77 0 0 1 33.79 0L416 239a24 24 0 0 1-.11 34z"
                class="fa-primary"
              ></path>
            </g>
          </svg>
        </a>
      </li>
    <li><img src="logo1.png" alt="" style="width:2rem; float:left;" class="logo"><a href="facemask.php" class=" link-text nav-link" > Face Masks</a></li>
    <li><img src="pillow.png" alt="" style="width:2rem; float:left;" class="logo"><a href="pillow.php" class=" link-text nav-link" >pillow</a></li>
    <li><img src="flowerpot.png" alt="" style="width:2rem; float:left;" class="logo"><a href="flowerpot.php" class="link-text nav-link" >flower Pot</a></li>
    <li><img src="glassball.png" alt="" style="width:2rem; float:left;" class="logo"><a href="glassball.php" class="link-text nav-link">Glass Ball</a></li>
	<li><img src="man.png" alt="" style="width:2rem; float:left;" class="logo"><a href="man.php" class="link-text nav-link">Man Clothes</a></li>
	<li><img src="woman.png" alt="" style="width:2rem; float:left;" class="logo"><a href="woman.php" class="link-text nav-link">Woman Clothes</a></li>
	<li><img src="beauty.png" alt="" style="width:2rem; float:left;" class="logo"><a href="beauty.php" class="link-text nav-link">Beauty Products</a></li>
	<li><img src="food.png" alt="" style="width:2rem; float:left;" class="logo"><a href="food.php" class="link-text nav-link">Snacks</a></li>
	<li><img src="tv.png" alt="" style="width:2rem; float:left;" class="logo"><a href="tv.php" class="link-text nav-link">Shows Hoodies</a></li>

  </div>
  </ul>
</nav>
<!-- Top menu on small screens -->

  <div style="margin-left:16rem; font-size:36px; color:black;">    <a href="home.php"><img src="logo.png" alt="LOGO" style="height:100px;"></a></div>  
<div style="margin-right:16rem; font-size:36px; color:black;float:right;margin-top:-60px;">
<form action="search.php" method="post">
<input type="text" name="name" class="box" onsubmit="search()"> 
</form>
</div>
<div style="margin-left:16rem;margin-top:3rem;">
<button class="button1" onclick="Show()"> Advanced Search</button>
<br>
<div id="section" style="display:none; ">
<form  action="#" method="post">
<br>
name<input type="text" name="name2" class="box1" > <br><br>
price:max:<input type="number" name="max" class="box2" > 
min:<input type="number" name="min" class="box2" > <br><br>
<div style="width:80%">Category: 
<br><input type="checkbox" name="list[]" value="woman"><label>Woman Clothes</label>
<input type="checkbox" name="list[]" value="man"><label>Man Clothes</label>
<input type="checkbox" name="list[]" value="snacks"><label>Snacks</label>
<input type="checkbox" name="list[]" value="beauty"><label>Beauty Products</label>
<input type="checkbox" name="list[]" value="pillow"><label>Pillow</label>
<input type="checkbox" name="list[]" value="hoodie"><label>Shows Hoodies</label>
<input type="checkbox" name="list[]" value="face_mask"><label>Face Mask</label>
<input type="checkbox" name="list[]" value="glass"><label>Glass Ball</label>
<input type="checkbox" name="list[]" value="flower"><label>Flower Pot</label></div> <br><br>
<button class="button1" type="submit" name="submit" value="submit"> Search</button><br>
</form>
</div>
</div>
<?php
$con = mysqli_connect("localhost","root","","gifty");
	if (mysqli_connect_errno()){
		echo "Failed to connect to MySQL: " . mysqli_connect_error();
		die();
		}
if(isset($_POST['name'])){
$name1=$_POST['name'];


$query="SELECT * FROM product WHERE Name LIKE '%$name1%' ORDER BY Category ";
$res=mysqli_query($con,$query);

$num=mysqli_num_rows($res);
if ($num==0){
	echo " There are no results";
}

 // Product grid 
 echo" <div class='w3-container w3-text-grey'  id='face-masks' style='margin-left:200px;'>
    <p >PRODUCTS</p>
    <p >$num items</p>
  </div>";
$category="";


 while ($row=mysqli_fetch_assoc($res)){
        
		$name = $row['Name'];
		$id = $row['Product_ID'];
		$price = $row['Price'];
		$image = $row['image'];
		$categ= $row['Category'];
	if	($category!==$categ)
	{ if ($category!=="")
		{echo "</div>";}
		$category=$categ;
		echo "
		<div style='margin-left:15.2rem;margin-right:4rem;float:left;' >

  <!-- Push down content on small screens -->
  <div class='w3-hide-large' style='margin-top:83px'></div>
  
  <!-- Top header -->
  <div class='w3-container w3-xlarge'> 
    <p class='w3-left'>$category</p><br><br>
  </div>
  <br><br>
		";
	}
	echo "
      <div class='product_wrapper'>
			  <form method='post' action='ind.php?page=product&id=$id'>
			  <div class='image'><img src='$image' /></div>
			  <div class='name'>$name</div>
		   	  <div class='price'>$price TND</div>
			  <button type='submit' class='buy'>Buy Now</button>
			  </form>
 </div>";}
}
	if(empty($_REQUEST['name2']) AND empty($_REQUEST['max']) AND empty($_REQUEST['min']) AND empty($_REQUEST['list']))
		{ echo "" ;}
	else {
$T['name']=$_REQUEST['name2'];
$T['max']=$_REQUEST['max'];
$T['min']=$_REQUEST['min'];
if (!empty($_REQUEST['list'])){
$T['list']=array_replace([],$_POST['list']);}
$query = "SELECT * FROM product WHERE ";
$condition=false;
  if (!empty($T['name']))
  {
	 if ($condition==false)
	{
	$query .= "Name LIKE '%".$T['name']."%'";
	$condition=true;
	}
	else
	{
		$query .= " AND Name LIKE '%".$T['name']."%'";
	}

 }
  if (!empty($T['max']))
  {
	 if ($condition==false)
	{
	$query .= "price <= '".$T['max']."'";
	$condition=true;
	}
	else
	{
		$query .= " AND price <= '".$T['max']."'";
	}

 }  if (!empty($T['min']))
  {
	 if ($condition==false)
	{
	$query .= " AND price >= '".$T['min']."'";
	$condition=true;
	}
	else
	{
		$query .= " AND price >= '".$T['min']."'";
	}
 }  if (!empty($T['list']))
  { if ($condition==true){
	  $query.=" AND ( ";}
  $condition1=false;
foreach ($T['list'] as $val){
	 if ($condition1==false)
	{
	$query .= "Category = '".$val."'";
	$condition1=true;
	}
	else
	{
		$query .= " OR Category = '".$val."'";
	}
}
if ($condition==true){
$query .= ")";}
 }

$res=mysqli_query($con,$query);
	$num=mysqli_num_rows($res);
if ($num==0){
 echo" <div class='w3-container w3-text-grey'  id='face-masks' style='margin-left:200px;'>
    <p >PRODUCTS</p>
	<p >$num items</p>
  </div>";
}

 // Product grid 
 echo" <div class='w3-container w3-text-grey'  id='face-masks' style='margin-left:200px;'>
    <p >PRODUCTS</p>
	<p >$num items</p>
  </div>";
$category="";


 while ($row=mysqli_fetch_assoc($res)){
        
		$name = $row['Name'];
		$id = $row['Product_ID'];
		$price = $row['Price'];
		$image = $row['image'];
		$categ= $row['Category'];
	if	($category!==$categ)
	{ if ($category!=="")
		{echo "</div>";}
		$category=$categ;
		echo "
		<div style='margin-left:15.2rem;margin-right:4rem;float:left;' >

  <!-- Push down content on small screens -->
  <div class='w3-hide-large' style='margin-top:83px'></div>
  
  <!-- Top header -->
  <div class='w3-container w3-xlarge'> 
    <p class='w3-left'>$category</p><br><br>
  </div>
  <br><br>
		";
	}
	echo "
      <div class='product_wrapper'>
			  <form method='post' action='ind.php?page=product&id=$id'>
			  <div class='image'><img src='$image' /></div>
			  <div class='name'>$name</div>
		   	  <div class='price'>$price TND</div>
			  <button type='submit' class='buy'>Buy Now</button>
			  </form>
		   	  </div>";}
}

?>
<br><br><br>
 <button type="button"  style="float:left;margin-left:47%; width:140px;heights:100px;border:0px;">
<a href="allproducts.php" style="text-decoration: none;"><img src="add.png" alt="" width="70px" height="70px">
<p style="float:bottom;font-size:20;color:grey;">See All Products</p></a>
</button>
<script>
function Show() {
  var x = document.getElementById("section");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "block";
  }
}
</script>
</body>
</html>

